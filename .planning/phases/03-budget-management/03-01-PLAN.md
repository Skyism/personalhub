---
phase: 03-budget-management
plan: 01
type: execute
---

<objective>
Create budget overview and creation UI for the Finance module.

Purpose: Enable users to view and create monthly budgets - the foundation for expense tracking.
Output: Budget list page, budget creation form, and budget detail view with TypeScript components.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-supabase-backend/02-02-SUMMARY.md
@lib/supabase/client.ts
@lib/supabase/server.ts
@lib/database.types.ts

**Tech stack available:**
- Next.js App Router with TypeScript
- Tailwind CSS for styling
- Supabase client utilities (browser + server)
- Database schema: budgets, categories, transactions tables

**Established patterns:**
- Dual client architecture (browser client for Client Components, server client for Server Components)
- Feature-based module structure (app/finance/)
- Mobile-first responsive design with Tailwind

**Constraining decisions:**
- Budget table schema: user_id, month (YYYY-MM string), total_budget (numeric)
- RLS policies ensure users only see their own budgets
- TypeScript strict mode enabled

**Database schema (budgets table):**
```typescript
{
  id: number
  user_id: string
  month: string // YYYY-MM format
  total_budget: number // numeric(10,2)
  created_at: string | null
}
```
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create budget list page</name>
  <files>app/finance/page.tsx, app/finance/budgets/page.tsx</files>
  <action>
    1. Update app/finance/page.tsx to be a simple landing page with navigation to /finance/budgets
    2. Create app/finance/budgets/page.tsx as a Server Component that:
       - Fetches all budgets for the current user using server Supabase client
       - Displays budgets in a list/grid sorted by month DESC (most recent first)
       - Shows: month (formatted as "January 2026"), total budget amount (formatted as currency)
       - Includes a "Create Budget" button linking to /finance/budgets/new
       - Uses Tailwind for mobile-first responsive styling
       - Handles empty state with message and CTA to create first budget

    For now, hardcode user_id as a placeholder (e.g., "00000000-0000-0000-0000-000000000000") since auth isn't implemented yet. Add a TODO comment indicating this needs auth.uid() once Supabase auth is set up.

    Use Server Components by default (faster, better SEO). Only use 'use client' if you need interactivity.
  </action>
  <verify>
    1. npm run dev starts without errors
    2. Visit http://localhost:3000/finance/budgets shows empty state
    3. TypeScript compilation passes: npm run build (or tsc --noEmit if available)
  </verify>
  <done>Budget list page renders with empty state, Create Budget button visible, no TypeScript errors</done>
</task>

<task type="auto">
  <name>Task 2: Create budget creation form</name>
  <files>app/finance/budgets/new/page.tsx, app/finance/budgets/actions.ts</files>
  <action>
    Create budget creation flow:

    1. Create app/finance/budgets/new/page.tsx as a Client Component ('use client') with:
       - Form with two fields: month (input type="month") and total_budget (input type="number" step="0.01")
       - Submit handler that calls a Server Action to insert budget
       - Success: redirect to /finance/budgets
       - Error handling: display error message above form
       - Cancel button linking back to /finance/budgets
       - Mobile-first form styling with Tailwind

    2. Create app/finance/budgets/actions.ts with Server Action:
       - 'use server' directive
       - createBudget(month: string, totalBudget: number) function
       - Uses server Supabase client to insert into budgets table
       - Validates: month is YYYY-MM format, totalBudget > 0
       - Returns { success: boolean, error?: string }
       - Uses hardcoded user_id for now (same as Task 1) with TODO comment

    Use Server Actions pattern (not API routes) - more efficient for Next.js App Router forms.
  </action>
  <verify>
    1. Visit http://localhost:3000/finance/budgets/new shows form
    2. Submit form with valid data (month: 2026-01, total: 1000.00)
    3. Redirects to /finance/budgets showing newly created budget
    4. Check Supabase dashboard or run SQL query to confirm budget inserted
  </verify>
  <done>Budget creation form functional, inserting to database, redirecting on success, handling errors gracefully</done>
</task>

<task type="auto">
  <name>Task 3: Create budget detail view</name>
  <files>app/finance/budgets/[id]/page.tsx</files>
  <action>
    Create budget detail page at app/finance/budgets/[id]/page.tsx as Server Component:

    - Dynamic route using [id] folder (catches budget ID)
    - Fetch single budget by ID using server Supabase client
    - Verify budget belongs to current user (RLS handles this, but also check explicitly)
    - Display: month (formatted), total budget (currency), created date
    - Show categories section (empty for now - Plan 2 will populate this)
    - Add "Edit Budget" and "Delete Budget" buttons (non-functional for now - add TODO comments)
    - Include breadcrumb or back button to /finance/budgets
    - Handle 404: if budget not found, show error and link back to list

    Make budget cards in the list page (Task 1) clickable links to this detail view.
  </action>
  <verify>
    1. Click a budget from list page navigates to /finance/budgets/[id]
    2. Detail page shows budget information correctly
    3. Back button returns to list
    4. Direct navigation to invalid ID shows 404 error
  </verify>
  <done>Budget detail view displays budget info, accessible from list, handles missing budgets gracefully</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds without TypeScript errors
- [ ] All three pages render correctly: list, new, detail
- [ ] Can create a budget and see it in the list
- [ ] Can click budget to view details
- [ ] Empty states handled properly
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Budget list page displays user's budgets sorted by month
- Budget creation form inserts to database and redirects
- Budget detail view shows individual budget information
- Mobile-first responsive styling throughout
- No TypeScript errors or warnings
</success_criteria>

<output>
After completion, create `.planning/phases/03-budget-management/03-01-SUMMARY.md`:

# Phase 3 Plan 1: Budget Overview & Creation - Summary

**[One-liner about what shipped]**

## Accomplishments

- [Key outcomes]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 03-02-PLAN.md (Category Management)
</output>
