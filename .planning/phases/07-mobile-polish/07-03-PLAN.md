---
phase: 07-mobile-polish
plan: 03
type: execute
---

<objective>
Optimize mobile form inputs with appropriate keyboards, autocomplete, focus management, and smooth scrolling for seamless data entry.

Purpose: Users frequently enter transactions on mobile after receiving SMS expense notifications. Optimize form inputs to show correct mobile keyboards (numeric for amounts, date picker for dates), prevent zoom issues, and provide smooth focus flow.
Output: Mobile-optimized forms with inputMode, autoComplete, proper input types, focus management, and scroll behavior.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-mobile-polish/07-01-SUMMARY.md
@.planning/phases/07-mobile-polish/07-02-SUMMARY.md

**Tech stack available:**
- Next.js 16 App Router
- React 19.2 with automatic focus management
- Tailwind CSS v4 for styling
- Mobile-first design patterns

**Established patterns:**
- Client Components for forms (TransactionForm, CreateCategoryForm)
- Server Actions for form submission
- Controlled inputs with React state

**Key files:**
@app/finance/budgets/[id]/TransactionForm.tsx
@app/finance/budgets/new/page.tsx
@app/finance/categories/CreateCategoryForm.tsx

**Current form state:**
- Amount inputs use type="number" (correct)
- No inputMode attribute (mobile keyboard optimization missing)
- No autoComplete attributes (browser autofill disabled)
- No focus management after form submit
- Date inputs use type="date" (correct) but no max attribute
- Select dropdowns don't specify autocomplete

**Issues being addressed:**
- iOS shows generic keyboard instead of numeric keyboard for amounts
- No autofill suggestions on mobile browsers
- After transaction submit, user must manually tap form again
- No smooth scroll to show focused input on small screens
- Category name inputs could benefit from autocomplete="off"
</context>

<tasks>

<task type="auto">
  <name>Task 1: Optimize transaction form inputs for mobile keyboards</name>
  <files>app/finance/budgets/[id]/TransactionForm.tsx</files>
  <action>
  Enhance TransactionForm with mobile-optimized input attributes:

  1. Amount input improvements:
     - Add inputMode="decimal" (shows numeric keyboard with decimal point on iOS/Android)
     - Add autoComplete="transaction-amount" (enables autofill if browser supports)
     - Keep type="number" for validation
     - Ensure text-base or larger (prevents iOS zoom)

  2. Date input improvements:
     - Add max={new Date().toISOString().split('T')[0]} to prevent future dates via native picker
     - Add autoComplete="bday" (closest semantic match for date input)
     - Ensure text-base or larger

  3. Category select improvements:
     - Add autoComplete="off" (prevent autofill for categories - user-specific)
     - Ensure text-base and py-3 (already done in 07-01)

  4. Note textarea improvements:
     - Add autoComplete="off" (notes are contextual, no autofill needed)
     - Add inputMode="text" for standard keyboard
     - Keep maxLength={500}

  5. Focus management after submit:
     - After successful transaction creation, reset form and keep focus in form area
     - Use useRef to focus amount input after successful submit: `amountInputRef.current?.focus()`
     - Add smooth scroll-margin-top to form for better mobile visibility

  Why inputMode matters: type="number" shows spinners on desktop but doesn't control mobile keyboard. inputMode="decimal" forces mobile numeric keyboard with decimal point.
  Avoid using autoComplete="on" generically - be specific with values or use "off" when not applicable.
  </action>
  <verify>Test on mobile device or DevTools mobile emulation: tap amount input shows numeric keyboard, tap date shows date picker, successful submit refocuses amount input</verify>
  <done>All inputs have appropriate inputMode and autoComplete attributes, focus management works after submit, mobile keyboards display correctly for each field type, TypeScript compiles without errors</done>
</task>

<task type="auto">
  <name>Task 2: Optimize budget creation and category forms</name>
  <files>app/finance/budgets/new/page.tsx, app/finance/categories/CreateCategoryForm.tsx</files>
  <action>
  Apply same mobile input optimizations to other forms in the app:

  1. Budget creation form (app/finance/budgets/new/page.tsx):
     - Month input: Add autoComplete="off" (month picker is date-based, no autofill)
     - Total budget input: Add inputMode="decimal" and autoComplete="off" (budget amounts are user-specific)
     - Ensure all inputs are text-base or larger
     - Add focus management: auto-focus first input on mount, smooth transitions between fields

  2. Category creation form (app/finance/categories/CreateCategoryForm.tsx):
     - Category name input: Add autoComplete="off" (user-defined categories, no autofill needed)
     - Add inputMode="text" explicitly
     - Ensure text-base minimum
     - Add focus to name input when form expands (if expandable like TransactionForm)

  3. Add smooth scroll behavior globally:
     - In app/globals.css, add: `html { scroll-behavior: smooth; }`
     - Ensures smooth scrolling when focus changes bring inputs into view on mobile

  Pattern: Forms that collect numeric data should use inputMode="decimal" or "numeric". Text fields should be text-base minimum (16px) to prevent iOS zoom.
  Avoid excessive autofocus - only on form expand or after successful submit where user likely wants to continue entering data.
  </action>
  <verify>Test each form on mobile: numeric keyboard appears for budgets, smooth scroll when focusing inputs near viewport edge, text inputs don't trigger zoom on focus</verify>
  <done>All forms have mobile-optimized input attributes, smooth scroll behavior enabled globally, focus management implemented, all forms prevent iOS zoom, TypeScript compiles without errors</done>
</task>

<task type="auto">
  <name>Task 3: Add loading states and disabled styling to form inputs during submission</name>
  <files>app/finance/budgets/[id]/TransactionForm.tsx, app/finance/budgets/new/page.tsx, app/finance/categories/CreateCategoryForm.tsx</files>
  <action>
  Improve form UX during submission by disabling all inputs and showing clear visual feedback:

  1. TransactionForm.tsx (if not already done):
     - Ensure all inputs have disabled={isSubmitting}
     - Add visual feedback: disabled inputs should have opacity-60 and cursor-not-allowed
     - Submit button already shows "Adding Transaction..." (keep this pattern)

  2. Budget creation form:
     - Add isSubmitting state if missing
     - Disable all inputs during submission
     - Update submit button text: "Creating Budget..." during submit
     - Add disabled styling

  3. Category creation form:
     - Add isSubmitting state if missing
     - Disable all inputs during submission
     - Update submit button text: "Creating Category..." during submit
     - Add disabled styling

  4. Standardize disabled input styling across all forms:
     - Use Tailwind: `disabled:opacity-60 disabled:cursor-not-allowed disabled:bg-gray-100`
     - Ensures consistent UX across all forms

  Why this matters: On slow mobile networks, form submission can take 1-2 seconds. Clear disabled state prevents double-submission and provides feedback that action is processing.
  Avoid keeping forms enabled during submission - users will tap submit multiple times on slow networks, creating duplicate records.
  </action>
  <verify>Submit each form on throttled network (Fast 3G), verify all inputs become disabled and visually grayed out, submit button shows loading text, no double-submissions possible</verify>
  <done>All forms disable inputs during submission, clear visual feedback with opacity and cursor changes, loading text on submit buttons, double-submission prevented, TypeScript compiles without errors</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] npm run build succeeds without errors
- [ ] npm run lint passes
- [ ] All numeric inputs show correct mobile keyboard (inputMode="decimal")
- [ ] Text inputs are 16px+ to prevent iOS zoom
- [ ] Smooth scroll behavior works globally
- [ ] Form inputs disable during submission with visual feedback
- [ ] Focus management works after form submit
- [ ] AutoComplete attributes appropriate for each field
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Mobile keyboards optimized (inputMode attributes)
- AutoComplete attributes set appropriately
- Focus management improves data entry flow
- Smooth scroll behavior implemented
- All forms prevent double-submission
- No iOS zoom issues on input focus
- No TypeScript errors
  </success_criteria>

<output>
After completion, create `.planning/phases/07-mobile-polish/07-03-SUMMARY.md`:

# Phase 7 Plan 3: Mobile Form and Input Optimization Summary

**[Substantive one-liner - what shipped]**

## Accomplishments

- [List key outcomes]

## Files Created/Modified

- `file.tsx` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

**Phase 7 complete** - Mobile experience fully polished with:
- Persistent navigation and 44px touch targets (Plan 1)
- Loading states and error boundaries (Plan 2)
- Optimized forms and mobile keyboards (Plan 3)

Ready for Phase 8: UI Overhaul - Transform visual design with distinctive aesthetics.
</output>
